{% extends "base_user.html" %}
{% load static %}

{% block title %}Rewards{% endblock %}
{% block page_title %} üéÅ Rewards{% endblock %}

{% block extra_head %}
<style>
  /* ===== Rewards ‚Äî Single Carousel, Desktop-first, Responsive, Autoplay ===== */
  .rw-scope{--rw-blue:#0a63ff;--rw-ink:#0f172a;--rw-muted:#6b7280;--rw-border:#e5e7eb}
  .rw-scope, .rw-scope *{box-sizing:border-box}
  .rw-wrap{max-width:1200px;margin:0 auto;padding:0 16px}

  .rw-card{
    margin:18px 0;border:1px solid var(--rw-border);border-radius:22px;
    background:linear-gradient(180deg,#fbfdff,#eef2f7);
    box-shadow:0 8px 28px rgba(15,23,42,.06);overflow:hidden
  }

  .rw-carousel{position:relative;overflow:hidden;border-radius:18px}
  .rw-track{display:flex;transition:transform .5s cubic-bezier(.22,.61,.36,1);will-change:transform}

  /* Slide ‚Äî image left, text right */
  .rw-slide{min-width:100%;padding:26px;display:grid;grid-template-columns:6fr 6fr;gap:22px;align-items:center}
  .rw-imgbox{
    position:relative;width:100%;aspect-ratio:16/9;border-radius:16px;overflow:hidden;background:#f3f6fb;
    box-shadow:0 10px 30px rgba(2,6,23,.06)
  }
  .rw-imgbox img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain}

  .rw-copy{padding-inline:6px}
  .rw-title{margin:0 0 6px;font-size:26px;font-weight:800;color:var(--rw-blue)}
  .rw-sub{margin:0;color:var(--rw-muted);font-size:14px}
  .rw-list{list-style:none;margin:16px 0 0;padding:0}
  .rw-list li{display:flex;gap:12px;align-items:baseline;margin:10px 0;font-size:15px;color:#334155}
  .rw-num{width:22px;color:#94a3b8;flex:none;text-align:right}
  .rw-get{color:#64748b}
  .rw-accent{color:var(--rw-blue);font-weight:700}
  .rw-fine{color:#64748b;font-size:14px;margin-top:14px}

  .rw-controls{display:flex;align-items:center;justify-content:space-between;padding:0 20px 18px}
  .rw-nav{display:flex;gap:10px}
  .rw-btn{
    width:44px;height:44px;border-radius:999px;border:1px solid #d1d5db;background:#fff;
    display:inline-flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;
    box-shadow:0 2px 6px rgba(0,0,0,.06)
  }
  .rw-btn:active{transform:scale(.98)}
  .rw-btn:focus-visible{outline:3px solid rgba(10,99,255,.35);outline-offset:2px;border-color:#9ec3ff}

  .rw-dots{display:flex;gap:8px;align-items:center}
  .rw-dot{width:8px;height:8px;border-radius:999px;background:#cbd5e1;border:0;cursor:pointer}
  .rw-dot.is-active{background:var(--rw-blue);width:20px;border-radius:6px}

  /* ===== Mobile / small screens ===== */
  @media (max-width:1023px){
    .rw-slide{grid-template-columns:1fr;gap:16px;padding:18px}
    .rw-title{font-size:22px}
  }
  @media (max-width:480px){
    .rw-card{border-radius:18px}
    .rw-imgbox{border-radius:12px}
    .rw-title{font-size:20px}
    .rw-sub{font-size:13px}
    .rw-list li{font-size:14px}
    .rw-btn{width:40px;height:40px}
    .rw-dot{width:7px;height:7px}
    .rw-dot.is-active{width:18px}
  }

  /* Respect reduced motion: keep transform snappy */
  @media (prefers-reduced-motion: reduce) {
    .rw-track{transition:transform .001s linear}
  }
</style>
{% endblock %}

{% block content %}
<div class="rw-scope" id="rwRewards">
  <section class="rw-wrap">

    <!-- ======== CAROUSEL: START ======== -->
    <div class="rw-card" aria-roledescription="carousel" aria-label="Rewards">
      <div class="rw-carousel">
        <div class="rw-track" aria-live="polite">

          <!-- ======== SLIDES: START (8 slides) ======== -->

          <!-- Slide 1 ‚Äî Deposit Bonus (overview) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal3.png' %}" alt="Deposit Bonus">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Deposit Bonus</h3>
              <p class="rw-sub">Reset Amount Reward</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">300 EUR</span><span class="rw-get">Get</span><span class="rw-accent">50 EUR</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">500 EUR</span><span class="rw-get">Get</span><span class="rw-accent">120 EUR</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">1000 EUR</span><span class="rw-get">Get</span><span class="rw-accent">250 EUR</span></li>
                <li><span class="rw-num">4.</span><span style="flex:1">1500 EUR</span><span class="rw-get">Get</span><span class="rw-accent">350 EUR</span></li>
              </ol>
              <div class="rw-fine">
                <div>Please contact customer service for reward.</div>
                <div>You can only collect once a day; reset the reward.</div>
              </div>
            </div>
          </article>

          <!-- Slide 2 ‚Äî Deposit Bonus (detail) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal5.png' %}" alt="Deposit Bonus Details">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Deposit Bonus</h3>
              <p class="rw-sub">Repeat of tiers for clarity</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">300 EUR</span><span class="rw-get">Get</span><span class="rw-accent">50 EUR</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">500 EUR</span><span class="rw-get">Get</span><span class="rw-accent">120 EUR</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">1000 EUR</span><span class="rw-get">Get</span><span class="rw-accent">250 EUR</span></li>
                <li><span class="rw-num">4.</span><span style="flex:1">1500 EUR</span><span class="rw-get">Get</span><span class="rw-accent">350 EUR</span></li>
              </ol>
              <div class="rw-fine"><div>Collect once per day.</div></div>
            </div>
          </article>

          <!-- Slide 3 ‚Äî Consecutive Days (overview) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal4.png' %}" alt="Consecutive Days Rewards">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Consecutive Days Rewards</h3>
              <p class="rw-sub">Work for consecutive days and receive a reward of:</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">5 days</span><span class="rw-get">Reward</span><span class="rw-accent">300 EUR</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">15 days</span><span class="rw-get">Reward</span><span class="rw-accent">700 EUR</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">30 days</span><span class="rw-get">Reward</span><span class="rw-accent">1,500 EUR</span></li>
              </ol>
            </div>
          </article>

          <!-- Slide 4 ‚Äî Consecutive Days (detail) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal2.png' %}" alt="Consecutive Days Details">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Consecutive Days</h3>
              <p class="rw-sub">Maintain streaks to unlock larger rewards.</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">5 days</span><span class="rw-get">Get</span><span class="rw-accent">300 EUR</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">15 days</span><span class="rw-get">Get</span><span class="rw-accent">700 EUR</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">30 days</span><span class="rw-get">Get</span><span class="rw-accent">1,500 EUR</span></li>
              </ol>
            </div>
          </article>

          <!-- Slide 5 ‚Äî About Gift Boxes (overview) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal2.png' %}" alt="About Gift Boxes">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">About Gift Boxes</h3>
              <p class="rw-sub">Have a chance to get 0‚Äì3 random Gift Boxes every round.</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">Gift Boxes Cash Bonus</span><span class="rw-get">Up to</span><span class="rw-accent">2,000 EUR</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">Gift Boxes Commission Bonus</span><span class="rw-get">Up to</span><span class="rw-accent">30√ó commission</span></li>
              </ol>
              <div class="rw-fine"><div>For more details, contact customer service.</div></div>
            </div>
          </article>

          <!-- Slide 6 ‚Äî Gift Boxes (detail) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal3.png' %}" alt="Gift Boxes Detail">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Gift Boxes</h3>
              <p class="rw-sub">Two types of Gift Boxes rewards are available.</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">Daily Box</span><span class="rw-get">Chance</span><span class="rw-accent">‚Ç¨5‚Äì‚Ç¨50</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">Milestone Box</span><span class="rw-get">Chance</span><span class="rw-accent">‚Ç¨20‚Äì‚Ç¨150</span></li>
              </ol>
              <div class="rw-fine"><div>Box odds reset weekly.</div></div>
            </div>
          </article>

          <!-- Slide 7 ‚Äî About Rank (overview) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal5.png' %}" alt="About Rank">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">About Rank</h3>
              <p class="rw-sub">Commission tiers & upgrade notes</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">VIP</span><span class="rw-get">Commission</span><span class="rw-accent">8‚Äì10%</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">VVIP</span><span class="rw-get">Commission</span><span class="rw-accent">10‚Äì12%</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">SVIP</span><span class="rw-get">Commission</span><span class="rw-accent">12‚Äì13%</span></li>
              </ol>
              <div class="rw-fine"><div>Contact Customer Service for more details.</div></div>
            </div>
          </article>

          <!-- Slide 8 ‚Äî About Rank (detail) -->
          <article class="rw-slide">
            <div class="rw-imgbox">
              <img loading="lazy" decoding="async" src="{% static 'meta_search/images/carousal2.png' %}" alt="About Rank Details">
            </div>
            <div class="rw-copy">
              <h3 class="rw-title">Rank Upgrade Details</h3>
              <p class="rw-sub">More constraints & upgrade hints</p>
              <ol class="rw-list">
                <li><span class="rw-num">1.</span><span style="flex:1">VIP</span><span class="rw-get">Note</span><span class="rw-accent">One withdrawal/day</span></li>
                <li><span class="rw-num">2.</span><span style="flex:1">VVIP</span><span class="rw-get">Note</span><span class="rw-accent">Two withdrawals/day</span></li>
                <li><span class="rw-num">3.</span><span style="flex:1">Upgrade</span><span class="rw-get">Recharge</span><span class="rw-accent">300 EUR</span></li>
              </ol>
              <div class="rw-fine"><div>SVIP can become an agent; subordinate commissions may apply.</div></div>
            </div>
          </article>

          <!-- ======== SLIDES: END ======== -->

        </div>
      </div>

      <div class="rw-controls">
        <div class="rw-nav">
          <button class="rw-btn" type="button" data-rw-dir="-1" aria-label="Previous">‚óÄ</button>
          <button class="rw-btn" type="button" data-rw-dir="1"  aria-label="Next">‚ñ∂</button>
        </div>
        <div class="rw-dots" role="tablist" aria-label="Slide indicators"></div>
      </div>
    </div>
    <!-- ======== CAROUSEL: END ======== -->

  </section>
</div>
{% endblock %}

{% block extra_scripts %}
{{ block.super }}
<script>
(function(){
  // Guard against double init if base injects twice
  if (window.__rwRewardsInit) return;
  window.__rwRewardsInit = true;

  const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  const AUTOPLAY_MS = 5000; // change speed here (ms)

  const card = document.querySelector('#rwRewards .rw-card');
  if (!card || card.dataset.rwInit === '1') return;
  card.dataset.rwInit = '1';

  const frame  = card.querySelector('.rw-carousel');
  const track  = card.querySelector('.rw-track');
  const slides = Array.from(track.children);
  const prev   = card.querySelector('[data-rw-dir="-1"]');
  const next   = card.querySelector('[data-rw-dir="1"]');
  const dotsEl = card.querySelector('.rw-dots');
  let i = 0, timer = null, playing = false, inView = true;

  // Build dots
  dotsEl.innerHTML = '';
  slides.forEach((_, k) => {
    const dot = document.createElement('button');
    dot.type = 'button';
    dot.className = 'rw-dot' + (k===0 ? ' is-active' : '');
    dot.setAttribute('aria-label', 'Go to slide ' + (k+1));
    dot.addEventListener('click', () => { go(k); restart(); });
    dotsEl.appendChild(dot);
  });

  function go(n){
    i = (n + slides.length) % slides.length;
    track.style.transform = 'translateX(' + (-i * 100) + '%)';
    dotsEl.querySelectorAll('.rw-dot').forEach((d,idx)=> d.classList.toggle('is-active', idx===i));
  }

  function start(){
    if (prefersReduced || slides.length < 2 || playing === true || !inView) return;
    playing = true;
    stop(); // just in case
    timer = setInterval(()=> go(i+1), AUTOPLAY_MS);
  }
  function stop(){
    if (timer) clearInterval(timer);
    timer = null; playing = false;
  }
  function restart(){ stop(); start(); }

  // Controls
  prev && prev.addEventListener('click', () => { go(i-1); restart(); });
  next && next.addEventListener('click', () => { go(i+1); restart(); });

  // Pause on hover/focus; resume on leave/blur
  card.addEventListener('mouseenter', stop);
  card.addEventListener('mouseleave', start);
  card.addEventListener('focusin', stop);
  card.addEventListener('focusout', start);

  // Touch: pause while swiping, resume after
  let downX = null;
  frame.addEventListener('touchstart', e=>{ downX = e.touches[0].clientX; stop(); }, {passive:true});
  frame.addEventListener('touchend', e=>{
    if(downX !== null){
      const dx = e.changedTouches[0].clientX - downX;
      if(Math.abs(dx) > 40){ go(i + (dx < 0 ? 1 : -1)); }
      downX = null;
    }
    start();
  }, {passive:true});

  // Pause when tab hidden
  document.addEventListener('visibilitychange', ()=> document.hidden ? stop() : start());

  // Pause when carousel not in viewport
  if ('IntersectionObserver' in window) {
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(entry => { inView = entry.isIntersecting; inView ? start() : stop(); });
    }, {threshold: 0.3});
    io.observe(card);
  }

  // Keyboard
  card.tabIndex = 0;
  card.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowLeft'){ go(i-1); restart(); }
    if(e.key === 'ArrowRight'){ go(i+1); restart(); }
  });

  // Hide controls if only one slide (safety)
  if (slides.length < 2) {
    const ctrls = card.querySelector('.rw-controls');
    if (ctrls) ctrls.style.display = 'none';
  }

  // Initial
  go(0);
  start();
})();
</script>
{% endblock %}
